---
title: 几个漫画整理脚本的使用
toc: true
tags:
  - 漫画
  - python
  - 阅读
categories:
  - 程序
date: 2021-07-03 15:10:01
---

---

## 注意事项

请先备份你的文件，使用后确实符合你的要求后再批量应用

拖拽：拖文件或文件到这个py文件上

递归：这个效果，对于文件夹和他的所有子文件夹都会有效

## 说明：

脚本下载地址：[Github：https://github.com/wangandi520/andyspythonscript](https://github.com/wangandi520/andyspythonscript)

使用前请先安装python[https://www.python.org/ftp/python/3.10.2/python-3.10.2-amd64.exe](https://www.python.org/ftp/python/3.10.2/python-3.10.2-amd64.exe)

官方网站[https://www.python.org/](https://www.python.org/)

别在baidu搜索或别的不明网站下载，谨防流氓软件

<!-- more -->

---

### 生成文件夹结构.html，支持搜索，简繁转换

**适用于搜索，分享，查看所有的库存资源**

*生成目录.html，支持搜索，简繁转换（拖拽，递归，仅一个文件夹）.py*

拖拽文件夹到py文件，被拖拽的目录下的所有文件，生成文件夹名.html，可搜索，点击Name回到首页

main()函数前几行可以进行一些自定义设置，文件夹名加粗显示

可进行的设置：显示完整地址还是只显示文件名，是否显示第一行，是否显示处理过程，键盘按键抬起立刻搜索还是按回车搜索，相对路径还是绝对路径，显示文件夹和文件还是只显示文件夹，是否显示文件大小，点击文件夹是搜索包含这个文件夹名的所有路径还是跳转到这个文件夹

自动搜索中文简体和繁体，可显示搜索结果的文件和文件夹的数量和总大小

html后加?search=关键词，打开网页时后自动显示搜索结果，例如1.html?search=伊藤润二

支持排除关键词，文件名中有关键词的文件不会写到html里，文件45行，keyWords = ['关键词1','关键词2','关键词3']

---

### 按文件夹名批量重命名已排序好的文件（夹）

**适用于已排序好的需要重命名的文件，拖拽文件夹拖到py文件上**

*文件名重命名成文件夹名+Vol_序号的格式（拖拽，仅多个文件夹）.py*

文件名重命名成文件夹名+Vol_序号的格式（拖拽，仅多个文件夹）.py

文件夹名的格式要符合"[书名][作者][出版社][扫者][10完]"，里面的文件会重命名成"[书名][作者][出版社][扫者]Vol_XX.XXX"的形式

以"完]"或"全]"结尾的，最后一个文件名会加上" End"，以"未]"结尾或其他结尾的则不加

按文件夹名批量重命名已排序好的文件，文件名无要求，但顺序要对

01,02,03......09,10可以。1,2,3......9,10这样顺序会出错

文件夹里可以是文件，或者文件夹，不支持混合

会生成日志和恢复文件名的bat文件，不过不想生成，就修改文件里的createLogAndRecover = False

---

### 文件名前两个[]的内容交换

**适用于个人习惯书名在前还是作者在前，拖拽文件（夹）拖到py文件上**

*文件名或文件夹名前两个[]的内容交换（拖拽，多个文件或文件夹）.py*

使用交换文件或文件夹名前两个[]的内容（拖拽，多个文件或文件夹）.py

把文件夹或文件名字中前两个[]的内容交换位置，支持多个文件夹或文件一起拖拽

"[书名][作者]"会重命名成"[作者][书名]

---

### 把[扫者]放在Vol之后

**适用于多个扫者的情况下卷的顺序错乱的情况，拖拽文件（夹）拖到py文件上**

*文件名最后[]和Vol_XX交换（拖拽，多个文件夹，文件名格式[][][][]Vol_XX）.py*

把文件（夹）名中最后[]的内容和Vol_XX交换位置

文件（夹）名格式[书名][作者][出版社][扫者]Vol_XX，会重命名成"[书名][作者][出版社]Vol_XX[扫者]"

支持多个文件夹或文件一起拖拽

---

### 根据文件（夹），创建作者和书名文件夹并移动文件进去

**适用于按作者分类整理，拖拽文件（夹）拖到py文件上**

*文件名识别作品名作者名并新建文件夹移动文件（拖拽，仅多个文件夹，文件夹名格式[作品][作者]XX）.py*
*文件名识别作品名作者名并新建文件夹移动文件（拖拽，仅多个文件夹，可简繁转换，文件夹名格式[作品][作者]XX）.py*
*文件名识别作品名作者名并新建文件夹移动文件（拖拽，仅多个文件，文件名格式[作品][作者]XX）.py*
*文件名识别作品名作者名并新建文件夹移动文件（拖拽，仅多个文件，可简繁转换，文件名格式[作品][作者]XX）.py*

文件（夹）名格式[书名][作者]XX.XX，新建文件夹名是作者（无方括号），二级文件夹名是书名（无方括号），被拖拽的文件（夹）会被移动到作品名文件夹里

简繁转换需要pip install opencc-python-reimplemented

---

### 文件名简繁体转换

*文件名和文件夹名简繁体转换（拖拽，递归，多个文件或文件夹）.py*

文件内设置简繁转换方向

简繁转换需要pip install opencc-python-reimplemented

### 根据rarzip文件是否包含文件夹分类

**适用于漫画整理**

*根据rarzip文件是否包含文件夹分类（拖拽，多个文件或文件夹）.py*

把zip，rar文件分成2类并放入对应的文件夹里

1.包含一个或多个二级文件夹。2.仅包含文件的。

需要pip3 install zipfile，pip3 install rarfile

---

### 复制出RAR或ZIP文件中的第一个文件

**适用于提取每卷漫画封面**

*复制出RAR或ZIP文件中的第一个文件（拖拽，多个文件或文件夹）.py*

需要UnRAR.exe 或 pip3 install unrar

支持压缩包里有一层或两层文件夹的情况

---

### 识别rarzip内是否有文件名是关键词的文件

**适用于发现压缩包里加没加广告**

*识别rarzip内是否有文件名是关键词的文件，(公众号)为例（拖拽，多个文件或文件夹，支持多层文件夹）.py*

如果压缩包里有文件夹包含"公众号"3个字，就会显示出这个压缩包的名字

---

### 根据漫画补档网址，生成帖子名.txt包含网址发布时间一楼内容

**适用于记录漫画信息**

*根据漫画补档网址，生成帖子名.txt包含网址发布时间一楼内容.py*

修改py内的url，获取漫画补档的某个帖子内容

---

### 计算文件sha1

*计算文件sha1（拖拽，递归，多个文件或文件夹）.py*

---

### 文件名中文改成拼音或拼音首字母

**加密**

*文件名中文改成拼音或拼音首字母（拖拽，递归，多个文件或文件夹）.py*

---

### 件名原扩展名后添加新扩展名，rar为例

*件名原扩展名后添加新扩展名，rar为例（拖拽，递归，多个文件或文件夹）*

---

### 图片高度和对应文件数量信息获取（拖拽，递归，多个文件或文件夹）.py

需要pip install pillow

文件内设置两种显示方式

---

### 搜索sha1相同的文件（拖拽，递归，多个文件或文件夹）.py

文件内设置显示方式

---

### 获取文件夹内文件的压缩文件多少大小类型sha1（拖拽，仅文件夹）.py

用于显示文件各种信息，整理

需要UnRAR.exe 或 pip3 install unrar

如果直接运行，存在文件夹名.sha文件的话，就开始校验文件

拖文件夹或.sha文件到脚本上，也可以校验

---

### 图片信息和颜色表或Photoshop .act文件信息获取（拖拽，多个文件或文件夹）.py

获取图片的宽度高度模式和颜色表，并输出到文件

读取Photoshop颜色表

---

### 图片旋转角度使用ImageMagick的convert（拖拽，多个文件或文件夹）.py

需要下载convert.exe

旋转，文件内修改角度

---

### 图片无损压缩使用pingo（拖拽，多个文件或文件夹）.py

**无损压缩**

需要 pip install piexif

压缩图片

---

### 图片按左右分割成两张图（拖拽，多个文件或文件夹）.py

裁剪分割图片，文件内设置参数

---

### 图片按坐标裁剪（拖拽，多个文件或文件夹）.py

文件内设置新图片的坐标

---

### 图片水平分割成两张图使用ImageMagick的convert（拖拽，多个文件或文件夹）.py

**分割图片**

需要下载convert.exe

拖拽文件夹到py上运行

---

### 图片每两张水平合并使用ImageMagick的convert（拖拽，仅文件夹）（拖拽，仅文件夹）.py

**制作双页图片，可跳过原来的双页**

需要下载convert.exe

拖拽文件夹到py上运行

文件夹内的第一张图如果不是单页，在文件内的setFirstSinglePage设置，比如第一张是单页，setFirstSinglePage = 0，第五张是单页，设置setFirstSinglePage = 4，会读取这页的宽度来判断哪些已经是双页的

---

### 图片文件夹或ziprar文件内的图片类型高度宽度大小信息生成.txt（拖拽，文件夹或ziprar）.py

get image's height,width, support zip and rar

支持zip,rar压缩包

需要pip install pillow

**适用于添加到压缩文件注释**

生成.txt文件包含信息：书名、作者、出版、扫者、类型数量、高度数量、文件数量、文件夹大小、文件夹创建时间、文件夹修改时间

---

### 图片文件夹或ziprar文件内的图片类型高度宽度大小信息生成到压缩文件的注释并压缩或添加注释（拖拽，文件夹或ziprar）.py

get image's height and put it into .zip file

需要pip install pillow

生成文件包含信息：书名、作者、出版、扫者、类型数量、高度数量、文件数量、文件夹大小、文件夹创建时间、文件夹修改时间

并创建zip文件，把上面的信息添加到注释里，压缩方式：存储

相当于上一个py脚本加上压缩文件这步整合起来

zip压缩包会添加注释，rar不会

---

### 文件名识别文件真正的扩展名并修改（拖拽，多个文件或文件夹）.py

get file's real suffix and rename

需要pip install fleep

默认只显示信息不修改扩展名，如果需要修改扩展名请把第14行改为renameToRealSuffix = True

---

### 文件扩展名修改，txt改zip为例=txt_zip（拖拽，多个文件或文件夹）

设置选项：
任何旧扩展名都改成新扩展名
没有扩展名的文件添加新扩展名

---

### 图片损坏检测（拖拽，多个文件或文件夹）.py

需要pip install pillow

检测图片损坏

使用pillow verify() 

---

### 使用mupdf包中的mutool提取pdf图片和字体（拖拽，多个文件或文件夹）.py

需要mutool.exe，下载地址https://mupdf.com/downloads/archive/mupdf-1.20.0-windows.zip

提取pdf图片和字体

---

### 把文件或文件夹添加密码后压缩为rar（拖拽，文件或文件夹）.py

需要Rar.exe

---

### 图片垂直或水平合并成一张图使用ImageMagick的convert（拖拽，仅多个文件）.py

把多张图片拖拽到文件上，生成新的合并后的图片，可以设置压缩比例和垂直或水平合并

---